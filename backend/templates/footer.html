<footer style="text-align: center; padding: 10px; background-color: #0074D9; color: white;">
    <p>&copy; 2025 VSL Online Judge - Shr3wcl</p>
</footer>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/codemirror.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/python/python.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/javascript/javascript.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.5/mode/clike/clike.min.js"></script>
<script>
    let editor = CodeMirror.fromTextArea(document.getElementById("codeEditor"), {
        lineNumbers: true,
        mode: "python",
        theme: "default",
        indentUnit: 4,
        matchBrackets: true,
    });

    function changeLanguage() {
        const language = document.getElementById("languageSelector").value;
        let mode;
        switch (language) {
            case "python":
                mode = "python";
                break;
            case "javascript":
                mode = "javascript";
                break;
            case "java":
                mode = "text/x-java";
                break;
            case "cpp":
                mode = "text/x-c++src";
                break;
            case "c":
                mode = "text/x-csrc";
                break;
        }
        editor.setOption("mode", mode);
    }

    async function runCode() {
        const code = editor.getValue();
        const language = document.getElementById("languageSelector").value;
        const outputArea = document.getElementById("outputArea");
        outputArea.textContent = "Running tests...";

        try {
            const response = await fetch(`/api/run?problem=square&language=${language}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({ code }),
            });

            if (!response.ok) {
                throw new Error('Failed to execute code');
            }

            const result = await response.json();

            // Display output in terminal-style format
            outputArea.textContent = '';
            if (result.results && result.results.length > 0) {
                result.results.forEach((test, index) => {
                    outputArea.textContent += `Test Case ${index + 1}\n`;
                    outputArea.textContent += `Input: ${test.input}\n`;
                    outputArea.textContent += `Output: ${test.output || 'No Output'}\n`;
                    if (test.expected) {
                        outputArea.textContent += `Expected: ${test.expected}\n`;
                    }
                    outputArea.textContent += `Result: ${test.result}\n`;
                    if (test.error) {
                        outputArea.textContent += `Error: ${test.error}\n`;
                    }
                    outputArea.textContent += `-----------------------------\n`;
                });
                if (result.flag) {
                    document.getElementById("flagArea").style.display = 'block';
                    document.getElementById("flagArea").textContent = "ðŸŽ‰ Congratulations! All test cases passed. Here is your flag: ðŸš©" + result.flag;
                }
            } else {
                outputArea.textContent = 'No test results available.';
            }
        } catch (error) {
            outputArea.textContent = `Error: ${error.message}`;
        }
    }
</script>